# main K3s server: cluster entry point for all VMs
name: main

resources:
  cloud: aws
  # must match AWS_DEFAULT_REGION
  region: us-east-1
  # https://docs.k3s.io/reference/resource-profiling: min. VM doubles resources
  cpus: 1+
  memory: 2+
  disk_size: 16

file_mounts:
  /scripts/k3s-server.py: ../setup/k3s-server.py

# sudo -E to preserve the environment, e.g. SKYPILOT_CLUSTER_INFO
setup: sudo -E /scripts/k3s-server.py
